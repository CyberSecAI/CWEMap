## Original Vulnerability Description

**_functions.php** in cpCommerce 1.2.x, possibly including 1.2.9, sends a redirect but **does not exit when it is called directly**, which allows remote attackers to bypass a protection mechanism to conduct **remote file inclusion and directory traversal attacks**, execute arbitrary PHP code, or read arbitrary files via the GLOBALS[prefix] parameter, a different vector than CVE-2003-1500.

## Extracted Key Phrases

| Category | Description |
|----------|-------------|
| **WEAKNESS** | **Remote file inclusion, directory traversal, arbitrary PHP code execution, arbitrary file reading** |
| PRODUCT | cpCommerce |
| VERSION | 1.2.x, possibly including 1.2.9 |
| ATTACKER | Remote attackers |
| IMPACT | Bypass protection mechanism, conduct remote file inclusion and directory traversal attacks, execute arbitrary PHP code, read arbitrary files |
| VECTOR | GLOBALS[prefix] parameter |
| **ROOTCAUSE** | **_functions.php sends a redirect but does not exit when it is called directly** |

## Assigned CWEs

| CWE-ID | CWE-Name | CWE-Description | CWE-Abstraction Level | CWE-Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|--------|----------|-----------------|------------------------|----------------------------------|----------------------------------|
| CWE-98 | PHP Remote File Inclusion | The PHP application receives input from an upstream component, but it does not restrict or incorrectly restricts the input before its usage in "require," "include," or similar functions. | Base | **Remote file inclusion** | This CWE directly relates to the remote file inclusion vulnerability described in the report. |
| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | The software uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the software does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory. | Base | **Directory traversal** | This CWE corresponds to the directory traversal vulnerability mentioned in the report. |
| CWE-94 | Improper Control of Generation of Code ('Code Injection') | The software constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code. | Class | **Arbitrary PHP code execution** | This CWE relates to the ability to execute arbitrary PHP code as described in the vulnerability. |
| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information. | Class | **Arbitrary file reading** | This CWE corresponds to the ability to read arbitrary files mentioned in the vulnerability description. |

## Similar CVEs from Observed Examples

| CWE-ID | CVE-ID | CVE-Description |
|--------|--------|-----------------|
| CWE-98 | CVE-2002-0661 | PHP **remote file inclusion** vulnerability in phpBB 2.0.0 allows remote attackers to execute arbitrary PHP code by modifying the phpbb_root_path parameter to reference a file on a remote web server. |
| CWE-22 | CVE-2005-2157 | **Directory traversal** vulnerability in the administrator component in Mambo 4.5.2.3 and earlier allows remote attackers to include and execute arbitrary local files via the mosConfig_absolute_path parameter. |
| CWE-98 | CVE-2006-2667 | PHP **remote file inclusion** vulnerability in includes/mx_functions_language.php in MaxWebPortal 1.0 allows remote attackers to execute arbitrary PHP code via a URL in the lang_path parameter. |
| CWE-22 | CVE-2006-3747 | **Directory traversal** vulnerability in the Glossary module in PHP-Nuke 7.9 and earlier allows remote attackers to read arbitrary files via a .. (dot dot) in the